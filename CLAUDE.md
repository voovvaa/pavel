# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

–≠—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è **Claude Code** (claude.ai/code) –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å –∫–æ–¥–æ–≤–æ–π –±–∞–∑–æ–π –ø—Ä–æ–µ–∫—Ç–∞.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –æ–±–∑–æ—Ä

–≠—Ç–æ **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π Telegram —á–∞—Ç-–±–æ—Ç** –ø–æ –∏–º–µ–Ω–∏ "–ì–µ–π—Å–∞–Ω–¥—Ä –ö—É–ª–æ–≤–∏—á", –∫–æ—Ç–æ—Ä—ã–π —Å–æ—á–µ—Ç–∞–µ—Ç:
- **–ü–∞—Ç—Ç–µ—Ä–Ω-–º–∞—Ç—á–∏–Ω–≥** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–∏—á–Ω–æ—Å—Ç–∏
- **AI-powered –æ—Ç–≤–µ—Ç—ã** —á–µ—Ä–µ–∑ OpenAI GPT-5  
- **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—É—é –ø–∞–º—è—Ç—å** —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º
- **–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** —á–µ—Ä–µ–∑ Vision API
- **–°–∏—Å—Ç–µ–º—É —Å–æ–±—ã—Ç–∏–π** –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π

**Runtime:** Bun —Å TypeScript, SQLite –≤—Å—Ç—Ä–æ–µ–Ω–∞, –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI.
**Deployment:** Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º CI/CD —á–µ—Ä–µ–∑ GitHub Actions, –¥–µ–ø–ª–æ–π –Ω–∞ Synology NAS.

## üîß –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### ü§ñ AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
- **`src/ai/ai-engine.ts`** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è OpenAI —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π GPT-5 (nano/chat-latest)
- **`src/ai/response-engine.ts`** - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π (AI vs –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
- **`src/ai/model-selector.ts`** - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### üíæ –°–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏
- **`src/memory/memory-manager.ts`** - SQLite –ø–∞–º—è—Ç—å —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
- **`src/memory/memory-viewer.ts`** - –£—Ç–∏–ª–∏—Ç—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞–º—è—Ç–∏
- **`memory.db`** - SQLite –±–∞–∑–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏, —Ç–µ–º–∞–º–∏, —Å–æ–±—ã—Ç–∏—è–º–∏

### üé≠ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞  
- **`src/ai/emotion-analyzer.ts`** - –ê–Ω–∞–ª–∏–∑ 24 —Ç–∏–ø–æ–≤ —ç–º–æ—Ü–∏–π + –≥—Ä—É–ø–ø–æ–≤–∞—è –¥–∏–Ω–∞–º–∏–∫–∞
- **`src/ai/emotional-adapter.ts`** - –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–¥ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **`src/analysis/user-profiler.ts`** - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üñºÔ∏è –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **`src/ai/image-analyzer.ts`** - GPT-4o Vision API —Å rate limiting
- **`src/ai/image-tester.ts`** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### üìÖ –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π (–≠–¢–ê–ü 9)
- **`src/core/event-tracker.ts`** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤
- **`src/core/activity-manager.ts`** - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–∞–º—è—Ç—å—é –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å–æ–±—ã—Ç–∏–π

### üìä –ê–Ω–∞–ª–∏–∑ —á–∞—Ç–æ–≤
- **`src/analysis/parser.ts`** - –ü–∞—Ä—Å–∏–Ω–≥ —ç–∫—Å–ø–æ—Ä—Ç–∞ Telegram (JSON —Ñ–æ—Ä–º–∞—Ç)
- **`src/analysis/analytics.ts`** - –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞
- **`src/analysis/pattern-extractor.ts`** - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ–≤–µ–¥–µ–Ω–∏—è

### üõ†Ô∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **`src/core/cache-manager.ts`** - –£–º–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- **`src/core/health-monitor.ts`** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
- **`src/utils/logger.ts`** - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Ä–æ–≤–Ω—è–º–∏

## üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### üß† –ì–∏–±—Ä–∏–¥–Ω–∞—è AI/–ü–∞—Ç—Ç–µ—Ä–Ω —Å–∏—Å—Ç–µ–º–∞
- **AI —Ä–µ–∂–∏–º** –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `AI_MODE` (patterns_only, ai_only, hybrid)
- **AI –æ—Ç–≤–µ—Ç—ã** –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, **–ø–∞—Ç—Ç–µ—Ä–Ω—ã** –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ä–µ–∞–∫—Ü–∏–π
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞–º—è—Ç–∏** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ AI –¥–ª—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### üíæ –ü–∞–º—è—Ç—å —Å —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- **–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è** —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (–≤–∞–∂–Ω–æ—Å—Ç—å, —ç–º–æ—Ü–∏–∏, —Ç–µ–º—ã)
- **–û—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –æ–±—â–∏–µ —Ç–µ–º—ã)
- **–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ–º—ã** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å —á–∞—Å—Ç–æ—Ç–æ–π —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –∏ –≤–∞–∂–Ω–æ—Å—Ç—å—é
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞–º—è—Ç–∏** —Å—Ç—Ä–æ–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ AI –æ—Ç–≤–µ—Ç–∞

### üé≠ –°–∏–º—É–ª—è—Ü–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏
- **–•–∞—Ä–∞–∫—Ç–µ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞** –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞
- **–ü—Ä–æ–º–ø—Ç—ã** –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–∏–∑–±–µ–≥–∞—é—Ç "–ø–æ–ø—ã—Ç–æ–∫ –∫–∞–∑–∞—Ç—å—Å—è –∫—Ä—É—Ç—ã–º")
- **–†–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤** –¥–ª—è nano vs –ø–æ–ª–Ω—ã—Ö GPT-5 –º–æ–¥–µ–ª–µ–π
- **–ü–∞—Ç—Ç–µ—Ä–Ω-–º–∞—Ç—á–∏–Ω–≥** –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞

### üìÖ –°–∏—Å—Ç–µ–º–∞ —É–º–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è (–≠–¢–ê–ü 9)
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —á–∞—Ç–∞
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π** —Å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–∞–º—è—Ç—å—é –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è** –ø–æ–¥ —Å–∏—Ç—É–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **–£–º–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏** –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å + —ç–º–æ—Ü–∏–∏ + —Å–∏—Ç—É–∞—Ü–∏–æ–Ω–Ω—É—é –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω–Ω–æ—Å—Ç—å

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
bun run dev

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫
bun start

# –ü—Ä–æ–¥–∞–∫—à–Ω —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
bun run build
bun run prod

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
bun run type-check
```

### Docker –¥–µ–ø–ª–æ–π (Production)
```bash
# –ü–æ–ª–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
bun run docker:deploy

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
bun run docker:build
bun run docker:up
bun run docker:down
bun run docker:logs

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –±—ç–∫–∞–ø—ã
bun run docker:update
bun run docker:backup
```

### –ê–Ω–∞–ª–∏–∑ –∏ —É—Ç–∏–ª–∏—Ç—ã
```bash
# –ê–Ω–∞–ª–∏–∑ —ç–∫—Å–ø–æ—Ä—Ç–∞ —á–∞—Ç–∞
bun run analyze

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏ –∏–∑ —á–∞—Ç–∞
bun run patterns

# –¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI –æ—Ç–≤–µ—Ç–æ–≤
bun run test-ai

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞–º—è—Ç–∏
bun run memory-stats

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
bun run generate-mock
```

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
bun run test-emotions
bun run test-emotional-adaptation

# –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π  
bun run test-images
bun run cost-analysis

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ AI –º–æ–¥–µ–ª–µ–π
bun run compare-models
bun run test-speed

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã
bun run health-check
bun run cache-stats
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–∞–º—è—Ç–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞
bun run memory-stats 316537427

# –ò–º–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞
bun run import-history --production
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
TELEGRAM_BOT_TOKEN=your_bot_token
ALLOWED_CHAT_ID=optional_specific_chat_id
DEV_MODE=true

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AI
OPENAI_API_KEY=your_openai_key
OPENAI_MODEL=gpt-5-nano          # gpt-5-nano | gpt-5-chat-latest
AI_MODE=hybrid                   # patterns_only | ai_only | hybrid
AI_PROBABILITY=0.8               # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å AI –æ—Ç–≤–µ—Ç–∞ (0.0-1.0)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–º—è—Ç–∏
DATABASE_PATH=./memory.db
MEMORY_DAYS=30
SUMMARY_AFTER_MESSAGES=50
SHORT_TERM_LIMIT=25
CONTEXT_RELEVANCE_THRESHOLD=0.7
```

### –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–µ–π
- **GPT-5 nano**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç reasoning_effort='low', verbosity='low' –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **GPT-5 chat-latest**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç temperature=0.7, top_p=0.95, store=true –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞

## üìä –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è** ‚Üí `bot.ts` –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Telegram
2. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** ‚Üí `memory-manager.ts` —Å—Ç—Ä–æ–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞–º—è—Ç–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. **–†–µ—à–µ–Ω–∏–µ –æ–± –æ—Ç–≤–µ—Ç–µ** ‚Üí `response-engine.ts` —Ä–µ—à–∞–µ—Ç AI vs –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è AI** ‚Üí `ai-engine.ts` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–∞–º—è—Ç–∏ (–µ—Å–ª–∏ AI —Ä–µ–∂–∏–º)
5. **–ü–∞—Ç—Ç–µ—Ä–Ω-–º–∞—Ç—á–∏–Ω–≥** ‚Üí –û—Ç–∫–∞—Ç –∫ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º `result_personality.json` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å** ‚Üí –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–º–∏ —Ç–µ–º–∞–º–∏, —ç–º–æ—Ü–∏—è–º–∏, –≤–∞–∂–Ω–æ—Å—Ç—å—é

## ü§ñ –†–∞–±–æ—Ç–∞ —Å AI –º–æ–¥–µ–ª—è–º–∏

### –†–∞–∑–ª–∏—á–∏—è GPT-5 –º–æ–¥–µ–ª–µ–π
- **nano**: –ë—ã—Å—Ç—Ä–∞—è, —ç–∫–æ–Ω–æ–º–∏—á–Ω–∞—è, –Ω–∏–∑–∫–∏–µ –ª–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤, —É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
- **chat-latest**: –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è, –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –ø—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏

### –ü—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥
- **–ü—Ä–æ–º–ø—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞** –≤ –º–µ—Ç–æ–¥–µ `buildPrompt()` –≤ `ai-engine.ts`
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞–º—è—Ç–∏** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Å—Ç–æ—Ä–∏–µ–π —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- **–ù–µ–¥–∞–≤–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏** —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –±–µ—Å–µ–¥–µ vs –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –∫—Ä—É—Ç–æ—Å—Ç–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ü—Ä–æ–º–ø—Ç—ã —Å–æ–∫—Ä–∞—â–µ–Ω—ã –≤ 3-5 —Ä–∞–∑** –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è AI –æ—Ç–≤–µ—Ç–æ–≤ (5 –º–∏–Ω—É—Ç TTL)
- **Rate limiting** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (30 —Å–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏)
- **Timeout protection** –¥–ª—è –≤—Å–µ—Ö async –æ–ø–µ—Ä–∞—Ü–∏–π

## üíæ –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–∞–º—è—Ç–∏

### –¢–∞–±–ª–∏—Ü—ã
- **`messages`**: –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- **`user_relationships`**: –ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç–∏–ø—ã –æ—Ç–Ω–æ—à–µ–Ω–∏–π  
- **`chat_topics`**: –ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ–º—ã —Å —á–∞—Å—Ç–æ—Ç–æ–π —É–ø–æ–º–∏–Ω–∞–Ω–∏–π
- **`emotional_profiles`**: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≠–¢–ê–ü 8)
- **`group_emotional_states`**: –ì—Ä—É–ø–ø–æ–≤—ã–µ —ç–º–æ—Ü–∏–∏ (–≠–¢–ê–ü 8)  
- **`chat_events`**: –°–æ–±—ã—Ç–∏—è —á–∞—Ç–∞ (–≠–¢–ê–ü 9)

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏** —Å–æ–æ–±—â–µ–Ω–∏–π
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–º–æ—Ü–∏–π**
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ç–µ–º**
- **–†–∞–∑–≤–∏—Ç–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º

## üìà –ò–º–ø–æ—Ä—Ç –∏ –∞–Ω–∞–ª–∏–∑ —á–∞—Ç–æ–≤

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- **–≠–∫—Å–ø–æ—Ä—Ç Telegram Desktop JSON** –≤ `chat/result.json`
- **–°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞**: `import-history.js` (—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤, –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–º—ã/—ç–º–æ—Ü–∏–∏)
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ Chat ID** –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–Ω–≤–µ–π–µ—Ä –∞–Ω–∞–ª–∏–∑–∞
1. **–ü–∞—Ä—Å–∏–Ω–≥** —Å—ã—Ä–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ Telegram (`parser.ts`)
2. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ** —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (`analytics.ts`)
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è** –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏ (`pattern-extractor.ts`)
4. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ** –±–∞–∑—ã –æ—Ç–≤–µ—Ç–æ–≤ (`result_personality.json`)

## üé≠ –õ–∏—á–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

–ë–æ—Ç —Å–∏–º—É–ª–∏—Ä—É–µ—Ç "–°–∞–Ω—è (–ì–µ–π—Å–∞–Ω–¥—Ä –ö—É–ª–æ–≤–∏—á)" —Å —ç—Ç–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏:
- **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π** —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —Å—Ç–∏–ª—å –±–µ–∑ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–ª–µ–Ω–≥–∞
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å** –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞
- **–£–º–µ—Å—Ç–Ω–æ–µ** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–≥–æ —è–∑—ã–∫–∞ –∫–æ–≥–¥–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç
- **–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π** –Ω–æ –Ω–µ –∏–∑–ª–∏—à–Ω–µ —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–∏—á–Ω—ã–π —Ç–æ–Ω
- **–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å** –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ—à–ª—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã

–ù–µ–¥–∞–≤–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –Ω–∞ —Ç–æ–º, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –º–µ–Ω–µ–µ "–∫—Ä–∏–Ω–¥–∂" –∏ –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ —Ä–∞–∑–≥–æ–≤–æ—Ä—á–∏–≤—ã–º, –∞ –Ω–µ –ø—ã—Ç–∞—é—â–∏–º—Å—è –∫–∞–∑–∞—Ç—å—Å—è –∫—Ä—É—Ç—ã–º.

## üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã
```
üß† –ì–µ–π—Å–∞–Ω–¥—Ä –ö—É–ª–æ–≤–∏—á –≤—Å–ø–æ–º–Ω–∏–ª —Å–≤–æ–∏ –ø—Ä–∏–≤—ã—á–∫–∏!
–ì–µ–π—Å–∞–Ω–¥—Ä –ö—É–ª–æ–≤–∏—á –æ—Ç–≤–µ—Ç–∏–ª –≤ —á–∞—Ç: "–î–∞, —Ç–æ—á–Ω–æ!"  
–ì–µ–π—Å–∞–Ω–¥—Ä –ö—É–ª–æ–≤–∏—á —Ä–µ—à–∏–ª –Ω–µ –≤—Å—Ç—Ä–µ–≤–∞—Ç—å –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä
```

### –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–ü—Ä–∏ `DEV_MODE=true` –≤—ã–≤–æ–¥–∏—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ:
- **–ü—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π** –æ–± –æ—Ç–≤–µ—Ç–µ
- **–í—ã–±–æ—Ä–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** vs AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–π** –∏ –ø–∞–º—è—Ç–∏
- **–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏** –∏ –∞–Ω–∞–ª–∏–∑–µ —Å–æ–±—ã—Ç–∏–π

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
–ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ** –∏–∑—É—á–µ–Ω–Ω—ã—Ö –º–∞–Ω–µ—Ä –ø–æ–≤–µ–¥–µ–Ω–∏—è
- **–£—Ä–æ–≤–µ–Ω—å** –≤–µ–∂–ª–∏–≤–æ—Å—Ç–∏ –∏ –æ–±—â–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
- **–ê–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Å—ã** –∏ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏
- **–õ—é–±–∏–º—ã–µ —Ç–µ–º—ã** –∏ —Å–ª–æ–≤–µ—á–∫–∏

## üö® –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** –∑–∞–≥—Ä—É–∑–∫—É –ª–∏—á–Ω–æ—Å—Ç–∏ –≤ –ª–æ–≥–∞—Ö
2. **–£–±–µ–¥–∏—Ç–µ—Å—å** —á—Ç–æ `PERSONALITY_FILE` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** —á—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ** `bun run health-check` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –ù–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–µ –æ—Ç–≤–µ—Ç—ã  
1. **–ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ** –ª–∏—á–Ω–æ—Å—Ç—å —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —á–∞—Ç–∞
3. **–†–∞—Å—à–∏—Ä—å—Ç–µ** —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ –≤ `parser.ts`
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** —á–µ—Ä–µ–∑ `bun run test-ai`

### –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: `bun run memory-stats`
2. **–û—á–∏—Å—Ç–∏—Ç–µ** –∫—ç—à–∏: `bun run cache-stats`
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ** API costs: `bun run cost-analysis`
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ** `AI_PROBABILITY` –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏

### Memory leaks –∏ –æ—à–∏–±–∫–∏
- **–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** –∑–∞—â–∏—â–µ–Ω—ã timeout (30-60 —Å–µ–∫)
- **Promise.race** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å—à–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **Graceful error recovery** –ø—Ä–∏ —Å–±–æ—è—Ö API

## üöÄ Production Deployment –Ω–∞ Synology NAS

### üîß –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ NAS

**1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
```bash
# –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ NAS —Å –Ω—É–ª—è
./scripts/setup-synology.sh <NAS_IP>
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç SSH –∫–ª—é—á–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ NAS
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ (docker-compose.yml, Dockerfile, package.json, —Å–∫—Ä–∏–ø—Ç—ã)
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (.env.docker, .nas.env)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Docker/Compose –Ω–∞ NAS
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—É—é –ª–∏—á–Ω–æ—Å—Ç—å –±–æ—Ç–∞

**2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Deploy Key:**
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–±–∞–≤—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ GitHub:
- **GitHub** ‚Üí Repository ‚Üí **Settings** ‚Üí **Deploy keys** ‚Üí **Add deploy key**
- –°–∫–æ–ø–∏—Ä—É–π –∫–ª—é—á –∏–∑ –≤—ã–≤–æ–¥–∞ `./scripts/setup-synology.sh`
- ‚úÖ –í–∫–ª—é—á–∏ **Allow write access**

**3. –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è:**
```bash
ssh -i ~/.ssh/synology_github_actions <user>@<nas_ip> "cd /volume1/docker/geysandr-bot && ./scripts/deploy.sh"
```

### üìä –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞ –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö:**
```bash
# –ü–æ–ª–Ω—ã–π –∏–º–ø–æ—Ä—Ç —á–∞—Ç–∞ –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏
./scripts/import-data-to-nas.sh <NAS_IP>
# –∏–ª–∏ —á–µ—Ä–µ–∑ npm
bun run import-data <NAS_IP>
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã —á–∞—Ç–∞ (result.json, result_analysis.json, result_personality.json)
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —É—Ç–∏–ª–∏—Ç—ã (import-history.js)
- ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤ –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –†–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ª–∏—á–Ω–æ—Å—Ç—å –∏–∑ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–¢—Ä–µ–±—É–µ–º—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `chat/result.json` - –≠–∫—Å–ø–æ—Ä—Ç Telegram —á–∞—Ç–∞ (24MB)
- `chat/result_analysis.json` - –ê–Ω–∞–ª–∏–∑ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ª–∏—á–Ω–æ—Å—Ç–∏ (28KB)
- `chat/result_personality.json` - –ì–æ—Ç–æ–≤–∞—è –ª–∏—á–Ω–æ—Å—Ç—å (32KB)
- `src/utils/import-history.js` - –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞

### üîÑ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞:**
```bash
# –ù–∞ NAS –≤—ã–ø–æ–ª–Ω–∏
./scripts/update.sh    # –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏
./scripts/deploy.sh    # –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
```

**–ë—ç–∫–∞–ø—ã:**
```bash
./scripts/backup.sh    # –°–æ–∑–¥–∞–µ—Ç –±—ç–∫–∞–ø –≤ backups/
```

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
```bash
# –ù–∞ NAS
docker compose ps                    # –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose logs -f geysandr-bot # –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```

**Health –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (–∫–æ–≥–¥–∞ —É—Ç–∏–ª–∏—Ç—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã)
docker compose exec geysandr-bot bun run health-check --quick
```

### üõ†Ô∏è Production Environment
- **Synology NAS** –∫–∞–∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ö–æ—Å—Ç–∏–Ω–≥–∞  
- **Docker Compose** –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **Named volumes** –¥–ª—è persistent –¥–∞–Ω–Ω—ã—Ö (bot-data, bot-logs)
- **Health monitoring** –≤—Å—Ç—Ä–æ–µ–Ω –≤ docker-compose.yml
- **Automated restart** –ø—Ä–∏ —Å–±–æ—è—Ö (restart: unless-stopped)

### ‚öôÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ NAS
```
/volume1/docker/geysandr-bot/
‚îú‚îÄ‚îÄ .env.docker              # Production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è  
‚îú‚îÄ‚îÄ .nas.env                 # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–µ–ø–ª–æ—è
‚îú‚îÄ‚îÄ docker-compose.yml       # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ Dockerfile              # –û–±—Ä–∞–∑ —Å Bun + TypeScript
‚îú‚îÄ‚îÄ package.json            # Dependencies + scripts
‚îú‚îÄ‚îÄ chat/
‚îÇ   ‚îî‚îÄ‚îÄ result_personality.json  # –õ–∏—á–Ω–æ—Å—Ç—å –±–æ—Ç–∞
‚îú‚îÄ‚îÄ data/                   # Volume –¥–ª—è SQLite –±–∞–∑—ã
‚îú‚îÄ‚îÄ logs/                   # Volume –¥–ª—è –ª–æ–≥–æ–≤  
‚îú‚îÄ‚îÄ backups/               # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
‚îî‚îÄ‚îÄ scripts/               # –°–∫—Ä–∏–ø—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ setup-git-auth.sh   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git SSH
    ‚îú‚îÄ‚îÄ deploy.sh           # –û—Å–Ω–æ–≤–Ω–æ–π –¥–µ–ø–ª–æ–π
    ‚îú‚îÄ‚îÄ update.sh          # –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    ‚îú‚îÄ‚îÄ backup.sh          # –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
    ‚îî‚îÄ‚îÄ autostart.sh       # –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ NAS
```

### üö® Troubleshooting

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `docker compose logs geysandr-bot`
2. –ü—Ä–æ–≤–µ—Ä—å —Ñ–∞–π–ª –ª–∏—á–Ω–æ—Å—Ç–∏: `cat chat/result_personality.json`
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker compose down && docker compose up -d`

**Health status DEGRADED:**
- –ù–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (–ø—É—Å—Ç–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- –ë–∞–∑–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å OpenAI API –∏ Telegram Bot API

**–ü—Ä–æ–±–ª–µ–º—ã —Å —É—Ç–∏–ª–∏—Ç–∞–º–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:**
- –£–±–µ–¥–∏—Å—å —á—Ç–æ –≤ Dockerfile —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ —É—Ç–∏–ª–∏—Ç—ã
- –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ —Å `docker compose build --no-cache`

**–ò–º–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ volume:**
- –ü—Ä–æ–±–ª–µ–º–∞: NODE_ENV –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –±–∞–∑–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ ./memory.db –≤–º–µ—Å—Ç–æ /app/data/memory.db
- –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É–π —Ñ–ª–∞–≥ `--production` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ import-history.js
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: `docker compose run --rm -v geysandr_bot_data:/app/data geysandr-bot bun run import-history --production`
- –ü—Ä–æ–≤–µ—Ä–∫–∞: `docker compose run --rm -v geysandr_bot_data:/app/data geysandr-bot ls -la /app/data/`

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –ª–∏—á–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è:
- **–ü–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç** —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **–û—Ç–≤–µ—á–∞–µ—Ç –≤ —Å—Ç–∏–ª–µ** –∏–∑—É—á–µ–Ω–Ω–æ–≥–æ —á–∞—Ç–∞ —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π
- **–£–º–µ–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –º–æ–º–µ–Ω—Ç—ã** –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ—Å—Ç—å** –≤ –æ–±—â–µ–Ω–∏–∏ —Å –∫–∞–∂–¥—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
- **–ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è** –∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å–æ–±—ã—Ç–∏—è–º —á–∞—Ç–∞
- **–ü–æ–º–Ω–∏—Ç –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ –Ω–∏—Ö —É–ø–æ–º–∏–Ω–∞–µ—Ç
- **–ì–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** —Å –ø–æ–ª–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é

**–ì–µ–π—Å–∞–Ω–¥—Ä –ö—É–ª–æ–≤–∏—á –≥–æ—Ç–æ–≤ –∫ –∂–∏–≤–æ–º—É –æ–±—â–µ–Ω–∏—é!** üöÄ

---

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 13 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–°—Ç–∞—Ç—É—Å:** Production Ready  
**–ü–æ–∫—Ä—ã—Ç–∏–µ:** –í—Å–µ —ç—Ç–∞–ø—ã 1-9 –∑–∞–≤–µ—Ä—à–µ–Ω—ã + –ø–æ–ª–Ω—ã–π CI/CD pipeline + –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Docker volume mount